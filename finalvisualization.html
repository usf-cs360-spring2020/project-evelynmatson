<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>DIY World Happiness Rank Visualization</title>

    <!-- Load Bulma from CDN (consider saving it to repository instead) -->
    <!-- https://bulma.io/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">

    <!-- Load Font Awesome 5 (free) icons -->
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <!-- Load d3 -->
    <!-- include d3.js v5 -->
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <!-- include d3.js modules -->
    <script src="https://d3js.org/d3-array.v2.min.js"></script>
    <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
    <script src="https://d3js.org/d3-time.v1.min.js"></script>
    <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
    <script src="https://d3js.org/d3-selection.v1.min.js"></script>
    <script src="https://d3js.org/d3-collection.v1.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-format.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale.v2.min.js"></script>
    <script src="https://d3js.org/d3-axis.v1.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo.v1.min.js"></script>
    <script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
    <script src="https://d3js.org/d3-ease.v1.min.js"></script>
    <script src="https://d3js.org/d3-timer.v1.min.js"></script>
    <script src="https://d3js.org/d3-transition.v1.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js" integrity="sha256-qo76Vs9B6JAALbrTn+PcN1r09hbNLd2M78V19glOMeU=" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>


    <!-- Lineup Scripts -->
    <link href="https://unpkg.com/lineupjs/build/LineUpJS.css" rel="stylesheet">
    <script src="https://unpkg.com/lineupjs/build/LineUpJS.js"></script>

    <!-- My CSS -->
    <link rel="stylesheet" href="style.css">

  </head>
  <body>

    <!-- Page header -->
    <!-- https://bulma.io/documentation/layout/hero/ -->
    <section class="hero is-primary is-bold">
      <div class="hero-body">
        <div class="container">
          <h1 class="title">DIY World Happiness Rank</h1>
          <h2 class="subtitle">By Evelyn Matson for CS 360 'Data Visualization'</h2>
        </div>
      </div>
    </section>
    <!-- End page header -->

    <!-- Page navigation -->
    <!-- https://bulma.io/documentation/components/navbar/ -->
    <nav class="navbar has-background-light" role="navigation" aria-label="main navigation">
      <div class="container">
        <div class="navbar-brand">
          <a class="navbar-item" href="index.html" title="Home">
            <span class="icon"><i class="fas fa-home"></i></span>
            <span>Home</span>
          </a>

          <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="main-menu">
            <span aria-hidden="true"></span>
          </a>
        </div>

        <div id="main-menu" class="navbar-menu has-text-weight-medium">
          <!-- Left navbar items -->
          <div class="navbar-start">

            <a class="navbar-item" href="about.html" title="About">
              <span class="icon"><i class="far fa-address-card"></i></i></span>
              <span>About</span>
            </a>

            <a class="navbar-item" href="dataset.html" title="Dataset">
              <span class="icon"><i class="fas fa-table"></i></span>
              <span>Dataset</span>
            </a>

            <a class="navbar-item is-active" href="finalvisualization.html" title="final visualization">
              <span class="icon"><i class="far fa-chart-bar"></i></span>
              <span>Final Visualization</span>
            </a>


            <!--          <div class="navbar-item has-dropdown is-hoverable">-->
            <!--            <a class="navbar-link"  href="index.html">-->
            <!--              Info-->
            <!--            </a>-->

            <!--            <div class="navbar-dropdown">-->
            <!--              <a class="navbar-item" href="index.html#about" title="About the Assignment">-->
            <!--                <span class="icon"><i class="far fa-file-alt"></i></span>-->
            <!--                <span>Assignment</span>-->
            <!--              </a>-->
            <!--              <a class="navbar-item" href="index.html#data" title="Dataset Info">-->
            <!--                <span class="icon"><i class="fas fa-table"></i></span>-->
            <!--                <span>Dataset</span>-->
            <!--              </a>-->
            <!--              <a class="navbar-item" href="index.html#wrangling" title="Dataset Info">-->
            <!--                <span class="icon"><i class="fas fa-wrench"></i></span>-->
            <!--                <span>Wrangling</span>-->
            <!--              </a>-->
            <!--              <a class="navbar-item" href="index.html#bio" title="About Me">-->
            <!--                <span class="icon"><i class="fas fa-info-circle"></i></span>-->
            <!--                <span>About me</span>-->
            <!--              </a>-->
            <!--            </div>-->
          </div>
          <!--          <a class="navbar-item" href="alphaprototypes.html" title="visualization">-->
          <!--            <span class="icon"><i class="fas fa-chart-bar"></i></span>-->
          <!--            <span>Visualization</span>-->
          <!--          </a>-->

        </div>

        <!-- Right navbar items -->
        <div class="navbar-end">
          <a class="navbar-item" href="feedback.html" title="Feedback">
            <span class="icon"><i class="fas fa-users"></i></i></span>
            <span>Feedback</span>
          </a>

          <a class="navbar-item" href="alphaprototypes.html" title="Prototypes">
            <span class="icon"><i class="fas fa-chart-bar"></i></span>
            <span>Alpha Prototypes</span>
          </a>
          <a class="navbar-item" href="betaprototypes.html" title="Prototypes">
            <span class="icon"><i class="fas fa-chart-bar"></i></span>
            <span>Beta Prototypes</span>
          </a>
          <!--        <a class="navbar-item" href="grade.html" title="About">-->
          <!--          <span class="icon"><i class="fas fa-tasks"></i></span>-->
          <!--          <span>Grade</span>-->
          <!--        </a>-->
        </div>
      </div>
      <!--      <a class="navbar-item" href="index.html#about" title="About">-->
      <!--        <span class="icon"><i class="fas fa-info-circle"></i></span>-->
      <!--        <span>About Me</span>-->
      <!--      </a>-->
      </div>
    </nav>
    <!-- End page navigation -->

    <!-- Begin page content -->
    <section class="section">
      <div class="container">

        <div class="content page-content">
          <h1 class="title">
            Final DIY World Happiness Rank Visualization
          </h1>

          <h3>Question</h3>
          <p><em>'Which country best matches my values?'</em></p>
          <p>
            This is the question I designed these visualizations to answer.
            The World Happiness Report reports an average 'happiness ladder' (<a href="https://worldhappiness.report/faq/#what-is-the-original-source-of-the-data-for-figure-21-how-are-the-rankings-calculated">More info about this metric</a>) score for each country, on a scale from one to ten.
            It then uses other data about each country and their own model to calculate six 'explained by' values for that country, as well as a residual (the amount of 'extra' happiness unexplained by those factors).
            These report how much of that country's happiness the researchers can ascribe to each of the following six factors :
          </p>
          <ul>
            <li>GDP per capita</li>
            <li>Social support</li>
            <li>Healthy life expectancy</li>
            <li>Freedom to make life choices</li>
            <li>Generosity</li>
            <li>Perceived (absence of) corruption</li>
          </ul>
          <p>Together, these seven factors (the 'residual', included) add up to the average happiness score recorded in each country.</p>

          <p>
            However, people are different! Some may want social support but not care much about GDP, and some the other way around.
            I designed this visualization so that people can customize how much weight each factor is given, then see how the countries may rank differently.
          </p>

          <h3>Answer</h3>
          <p>
            Everyone's answer to this question will be different, so give it a try (it seems to work best in Google Chrome)! Tweak the calculation to match what you value most, and find which countries most closely match those values.
          </p>

          <h3>Interactivity</h3>
          <p>
            This visualization's main form of interactivity is the ability to scale each factor's weight using the range sliders, then see the map and lineup update.
            To use this, drag the control element of a slider to the left or right (left will give this factor less weight, right will give it more).
            After you let go, the visualization will update, reordering countries in the small multiples the bar chart according to remain sorted given their newly weighted values.
            The map and its scale will also update, to show which countries have the largest (happiest) and smallest (least happy) weighted happiness values given the new weights that have been inputted.
          </p>
          <p>
            I have also implemented a hover tooltip in the map, so that hovering over a country will highlight its outline, and display a tooltip with its name and details about its value for each factor.
          </p>
          <p>
            Finally, I have made the bar chart scrollable to allow people to see the map at the same time as the end of the ranked bars.
            This isn't exactly interactivity in the strict sense, but it does enable people to explore the data more effectively, so it counts as interactivity in a way!
          </p>

          <br>
          <!-- Sliders -->
          <div class="slidecontainer" style="width:800px">
            <datalist id="steplist">
              <option>0</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
              <option>5</option>
              <option>6</option>
              <option>7</option>
              <option>8</option>
              <option>9</option>
              <option>10</option>
            </datalist>

            <h4>Happiness Explaining Factors</h4>
            <table>
              <tbody>
              <tr>
                <td>Freedom to make life choices</td>
                <td>Generosity</td>
                <td>Healthy life expectancy</td>
                <td></td>
              </tr>
              <tr>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Freedom to make life choices" list="steplist"></td>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Generosity" list="steplist"></td>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Healthy life expectancy" list="steplist"></td>
                <td></td>
              </tr>
              <tr>
                <td>Log GDP per capita</td>
                <td>Perceptions of corruption</td>
                <td>Social support</td>
                <td>Residual</td>
              </tr>
              <tr>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Log GDP per capita" list="steplist"></td>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Perceptions of corruption" list="steplist"></td>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Explained by: Social support" list="steplist"></td>
                <td><input type="range" min="0" max="10" value="5" class="slider" id="Dystopia + residual" list="steplist"></td>

              </tr>
              <tr>
              </tr>
              <tr>
              </tr>
              </tbody>
            </table>

          </div>
          <br>

          <!-- Map Visualization -->
          <svg id="mapVisualization" class="visualization">
            <g id="graticule"></g>
            <g id="countries"></g>
          </svg>

          <!-- Lineup visualization-->
          <div class="scrollable" style="width:800px">
            <svg id="lineupVisualization" class="visualization"></svg>
            <script src="resources/my-lineup.js"></script>
          </div>


          <h3>Encodings</h3>
          <p>
            In the map, data is encoded on as color on a choropleth visualization on an equal area map projection. Each colored shape is a country, and data is encoded as follows :
          </p>
          <ul>
            <li>Location of the country : where in the world the country is located (projected using the Natural Earth projection) (North is up, East is right)</li>
            <li>Area of country on the map : the area of the country in the world</li>
            <li>Color of country : weighted happiness value calculation (see legend)</li>
          </ul>

          <p>
            In the small multiples bar chart that follows, each country is represented by a row of data bars, and each bar encodes the data value for one of the seven explaining factors.
            The rows are sorted by the sum of each explaining factor, so that the countries with the greatest average happiness value are the highest.
            The rows are automatically re-sorted based on the weight factors the user sets on the slider input controls whenever the weights change.
            More specifically :
          </p>
          <ul>
            <li>Vertical location of row/country : weighted average happiness rank of that country (higher happiness values are higher up)</li>
            <li>Vertical location of a bar/explaining factor : which country it refers to</li>
            <li>Horizontal location of a bar/explaining factor : which factor it is (see labels at top)</li>
            <li>
              Width of the bar : the country's value for that explaining factor<br>
              <em>Each factor has a different scale, but the specific values are unimportant and are not displayed.
                The bars are for the purpose of comparison, not for exact value calculation. </em>
            </li>
          </ul>

<!--        <h3>About</h3>-->
<!--        <p>In order to explore the datasets a bit, I created two prototype visualizations in Tableau.</p>-->

<!--        <br>-->
<!--        <h3>Bubble Plot Visualization</h3>-->
<!--        <p>The first is a multivariate bubble plot of various countries, encoding several different metrics. Each bubble is a country, and information about them are encoded in the following ways :</p>-->
<!--        <ul>-->
<!--          <li>Color of bubble - amount of income inequality as a GINI coefficient (blue means more equal, red means less. See legend.)</li>-->
<!--          <li>Size of bubble - most recent population size (larger is more populous)</li>-->
<!--          <li>Horizontal position of bubble - average happiness ladder score (further right is happier)</li>-->
<!--          <li>Vertical position of bubble - GDP per capita on a logarithmic scale (higher is greater GDP per capita)</li>-->
<!--        </ul>-->
<!--        <img src="resources/prototypes/Bubble%20Dashboard.png">-->


<!--        <br>-->
<!--        <h3>Stacked Bar Visualization</h3>-->
<!--        <p>The second is a stacked bar chart where each bar is a country, and the heights of different colors correspond to different factors that contribute to happiness.-->
<!--          Each of the six factors identified by the World Happiness Report is represented by a color (see legend), and the pink color shows the 'residual' amount of happiness.-->
<!--          This is the 'extra' amount of happiness not explained in their model by the measured values for each of the six factors.-->
<!--          The data is encoded as follows : </p>-->
<!--        <ul>-->
<!--          <li>Height of bar - average happiness ladder score</li>-->
<!--          <li>Height of colored sections - amount of happiness 'explained by' a given factor's measured value in the researchers' model</li>-->
<!--          <li>Height of pink section - residual happiness, or the 'extra' amount of happiness not explained in the model by the six factors</li>-->
<!--        </ul>-->
<!--        <img src="resources/prototypes/Stack%20Dashboard.png">-->

        <!--        <p>This is a small multiples parallel coordinates chart that compares different college tiers' impact on their students' economic outcomes, and examines in what ways this depends on the students' economic backgrounds.</p>-->
<!--        <p>Here, <strong>each line represents a cohort of students from a certain economic background, going to a certain college</strong>. Infomation about their cohort is encoded in the following way : </p>-->
<!--        <ul>-->
<!--          <li><strong>Color of line</strong> - Economic background, determined by their parents' income quintile. Yellow lines represent the most wealthy backgrounds, and purple lines represent the least wealthy backgrounds. See legend.</li>-->
<!--          <li><strong>Height of line on axis</strong> - Percent of cohort who end up in that income quintile. Higher values meaan higher percents, and axes further to the right are wealthier.</li>-->
<!--          <li><strong>Location of subplot</strong> - Each subplot is labeled with the tier of college it represents. Subplots are broadly grouped near similar tiers of school for ease of comparison.</li>-->
<!--          &lt;!&ndash;          <li>Opacity of line - Representation of that economic background in a college's student body, determined by percentage of students at that college who come from that same economic background. A more prominent line means a greater percentage of students at that college come from that same background, and a fainter line means students from that background are underrepresented at that college.</li>&ndash;&gt;-->
<!--        </ul>-->
<!--        <p>Broadly, tiers where <strong>all the lines are close together</strong> regardless of their color demonstrate student outcomes uninfluenced by economic background, and tiers where the <strong>lines separate based on color</strong> show student outcomes that differ based on economic background.</p>-->
<!--        <p>Also, for a any line or group of lines, a <strong>positive trend</strong> (lower on the left ond higher on the right) shows that students in that cohort are more likely to end up in a wealthy income quintile.-->
<!--          A <strong>negative trend</strong> (higher on the left and lower on the right) shows that students in that cohort are more likely to end up in a less wealthy income quintile.</p>-->

<!--        <h3>Conclusions</h3>-->
<!--        <p>The visualization was designed to support the study's second finding, and seems to do so. The authors of the study write:</p>-->
<!--        <blockquote>Second, children from low- and high-income families have similar earnings outcomes conditional on the college they attend, indicating that low-income students are not mismatched at selective colleges.</blockquote>-->
<!--        In this visualization, higher college tiers (especially "Ivy Plus") have plots where the lines are all tightly bound together, regardless of what quintile of economic background they represent.-->
<!--        <p>This supports the finding by showing that students who attend elite schools can expect similar outcomes regardless of their backgrounds.</p><br>-->
<!--        <p>Additionally, in this visualization the plots of lower tier schools (especially "Two-Year (Public + Private) show lines clearly separated by color.-->
<!--          Purple and blue lines mostly peak an the left side of the graph, and yellow and light green lines mostly peak on the right side of the graph.-->
<!--          This shows that students who attend these lower-tier colleges have very different economic outcomes depending on their background.-->
<!--          Students who go to these schools often end up wealthy when they come from wealthy backgrounds, but often end up in the working class when they come from working class backgrounds.</p>-->


<!--        <h3>Prototypes</h3>-->
<!--        <p>I used <a href="https://rawgraphs.io">RawGraphs</a> for initial prototyping, then moved to D3 to implement my final visualization.-->
<!--          I was unable to filter rows out of the dataset using RawGraphs, so I changed the color for unwanted lines to be white.-->
<!--          This helped emphasize the data I wanted to see, but then it became partially obscured by a plethora of annoying white lines.</p>-->
<!--        <p>I also intended to display multiple lines from the same college on the same graph, each representing different parent income quintiles, but RawGraphs wouldn't allow me to do this without doing some serious wrangling.-->
<!--          Here I have displayed two prototype graphs I made, each showing two college tiers but only data for one parent income quintile.</p><br>-->


        </div>
      </div>
    </section>
    <!-- End page content -->

    <!-- Page footer -->
    <!--  <div class="false-footer"></div>-->
    <!-- https://bulma.io/documentation/layout/footer/ -->
    <footer class="footer smaller-footers-are-better">
      <div class="content has-text-centered is-size-7">
        <p>
          <a href="https://github.com/usf-cs360-spring2020/template-bulma" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
            <i class="fab fa-github-alt"></i>&nbsp;<strong>Github</strong>
          </a>

          <a href="https://fontawesome.com/" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
            <i class="fab fa-font-awesome"></i>&nbsp;<strong>FontAwesome</strong>
          </a>

          <a href="https://bulma.io" class="button is-small">
            <img src="https://bulma.io/images/made-with-bulma--semiblack.png" alt="Made with Bulma" width="128" height="24">
          </a>
        </p>
      </div>
    </footer>
    <!-- End page footer -->

    <!-- Mobile menu responsiveness -->
    <!-- https://bulma.io/documentation/components/navbar/ -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

        if ($navbarBurgers.length > 0) {
          $navbarBurgers.forEach( el => {
            el.addEventListener('click', () => {
              const target = el.dataset.target;
              const $target = document.getElementById(target);
              el.classList.toggle('is-active');
              $target.classList.toggle('is-active');
            });
          });
        }
      });
    </script>
    <!-- End mobile menu responsiveness -->

  </body>

</html>
